FROM heartysoft/docker-builder-aws:latest

ENV KUBE_VERSION 1.6.4
ENV HELM_VERSION 2.5.0

COPY configure-helm.sh /usr/bin/

RUN apk update \
 && apk add grep \
 && mkdir -p /tmp/helm \
 && curl -LO https://storage.googleapis.com/kubernetes-release/release/v${KUBE_VERSION}/bin/linux/amd64/kubectl \
 && chmod +x ./kubectl \
 && mv ./kubectl /usr/bin/kubectl \
 && curl https://storage.googleapis.com/kubernetes-helm/helm-v${HELM_VERSION}-linux-amd64.tar.gz | tar -xzv -C /tmp/helm \
 && mv /tmp/helm/linux-amd64/helm /usr/bin/helm \
 && chmod +x /usr/bin/configure-helm.sh \
 && rm -rf /tmp/helm \
 && rm -rf /var/cache/apk/* \
 && echo ". /usr/bin/configure-helm.sh" > /root/.ashrc \
 && echo ". /usr/bin/configure-helm.sh" > /root/.bashrc \
 && echo ". /usr/bin/configure-helm.sh" > /root/.profile \
 && rm -rf /root/.cache

ENV ENV="/root/.ashrc"
